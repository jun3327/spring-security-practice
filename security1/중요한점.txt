스프링 시큐리티의 동작 방식

- 서버의 세션 저장소 안에, 스프링 시큐리티가 관리하는 세션이 따로 있다.
- 시큐리티 세션 안에 저장될 수 있는 객체는 Authentication 객체 뿐이다. 이 객체가 세션에 들어온 순간 로그인이 된거다.
- 이 Authentication 객체를 컨트롤러에서 필요할 때 DI 할 수 있다.
- Authentication 안에는 두 개의 타입이 있다. (UserDetails, OAuth2User)
- 일반 로그인을 진행하면 UserDetails 타입으로, OAuth2 로그인을 진행하면 OAuth2User로 들어온다.

- 근데, 컨트롤러에서 OAuth2User 인지, UserDetails 인지에 따라 구분하여 처리하기가 매우 빡세다
- 그래서, Authenticaion 안에 들어가는 객체를 하나 만들어서(PrincipalDetails), 그 객체가 UserDetails와 OAuth2User를
모두 상속해서 구현하도록 만든다.
- 그렇게 하면 컨트롤러에서 둘을 구분해서 받을 필요가 없다. 오직 PrincipalDetails에 관하여 처리하면 된다.